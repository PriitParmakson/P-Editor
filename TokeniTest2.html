<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mall</title>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery.min.js"></script>

  <!-- Material Design icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
    crossorigin="anonymous">
  <!-- Tether on vaja tooltip-de jaoks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" crossorigin="anonymous"></script>

  <!-- Stiilid -->
  <link rel='stylesheet' href='css/Samas.css'>
  <style></style>

  <!-- JS RSA Sign
    vt https://github.com/kjur/jsrsasign/wiki/Tutorial-for-JWT-verification -->
  <script src="https://kjur.github.io/jsrsasign/jsrsasign-latest-all-min.js"></script>
  <!-- script src=''></script -->

  <script>
    function alusta() {
      /*
        Google serdid (PEM): https://www.googleapis.com/oauth2/v1/certs

        Verifitseerimismeetod vt: https://kjur.github.io/jsrsasign/api/symbols/KJUR.jws.JWS.html#.verifyJWT 
      */

      var token = 'eyJhbGciOiJSUzI1NiIsImtpZCI6IjVjMjk5YzFhZWI3MGE4YzdiZmVjMDRjNGUxNmUwODAyMDE3ZTA2MDYifQ.eyJhenAiOiI0MDc0MDg3MTgxOTIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI0MDc0MDg3MTgxOTIuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDU5ODM3MTY4OTk0MjcxNTkwOTciLCJhdF9oYXNoIjoiemUtX3VPZFNmQ3V6d2s0dGxBYkxHQSIsImlzcyI6Imh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbSIsImlhdCI6MTUwMDYzMjg2MSwiZXhwIjoxNTAwNjM2NDYxLCJuYW1lIjoiUHJpaXQgUGFybWFrc29uIiwicGljdHVyZSI6Imh0dHBzOi8vbGg2Lmdvb2dsZXVzZXJjb250ZW50LmNvbS8tTmJCcmVsZ21Ha0EvQUFBQUFBQUFBQUkvQUFBQUFBQUFBQUEvQUk2eUdYekVMZDEybThfTVR6OU01cVVLN01mQVhhLUQ2Zy9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoiUHJpaXQiLCJmYW1pbHlfbmFtZSI6IlBhcm1ha3NvbiJ9.EDanWHnYROP11SXUJrvN85dqK2yL5-MxmKhs5squ_cOsEFOuxAYYLzDQAzmJvvyun3Mmda0118T3npofAHV_utpPFukVOCSBUI7MR4ep3-h2xxRnbfnltAaLILwKA_ZRZ5wq0icWJA5NNX9oJH-eurjduK5C0Lc20d4cH-aHNGWZ1xDFp4NQvfRsQ51JbiXjV0G9rlYqkhb4tKDvhhNHHNUGkxUaDYEzKbiG3VNo43LD1TdSNsVXMtcCjHMAuExcSWCBOqQJ7eJAGPit6oyZN6o4-zo4eZbP6ivlioyfTAwUtLS7AxTPaiW3vMiaNeo2XiRkic0mSz5vPDB3MQbaOQ';

      var certStrReavahetustega = '-----BEGIN CERTIFICATE-----\nMIIDJjCCAg6gAwIBAgIIOY537b/+arcwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UE\nAxMrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAe\nFw0xNzA3MTkxMTQzMzRaFw0xNzA3MjIxMjEzMzRaMDYxNDAyBgNVBAMTK2ZlZGVy\nYXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCtLgtvMHohkhg1RW8Vga/YuB3b/tg9D2dr\nAtMBC7I5uMkJ9x6nf8Ajhlxy0Reos1vzwFQUOsknw3fDR+3Unf/E4eLJO8BzFOUY\nynpIofsTDXB7k8hKdwXvPLRw62vlSa3SiSy5FOTmJgxnrNNXiPjglsXzxRoHBXVm\nTlPgD5/isn5yY7Jttk+zM+FjhwW5muMnIGQL6t+rJSUtsnasH9hGkzQGkPbBns5m\n6Nt+HUtTkrOySIqW3T3zTImnEEzhddT4vp5UfH4wVea/h+nsmxUkhnktQz0ggQsI\nKxezugnVz2fWQjBkOUmmyQ3gujlzHn1blzh6oZxZX2u4EGkp671ZAgMBAAGjODA2\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsG\nAQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQAGamEfzsDLkGB2uv7SuGLDU1J3Q6ws\nDKv0tRhZ7DWnszY3CF0yYHeaRdJd0mu0lGYGAowQbgMuCgQHqXqjQeu18y21v1DW\nPPRQIuVkMTEz5U7xG4A3zOtlqHouGGTafpX+vywwGxTOcgzPPI1DTmTJTci9YEtV\nMTCBGb87eZlKHXGdnu+SvO7zTMKeaRu+BLMQDJbIpSMJI1mDzgKMWeo2RxuU+XKL\nkfyW70F1jy3mGYawznzKi8/xpMqkK6NIlsHZKV9TmdUVV0THvnWCG3ntyh3IGOF7\n8GHxqvDEGftSBnuwRSIerVFsWfzgEaJcO/RofW3Jfh0SfgxZsQ9Zvuqu\n-----END CERTIFICATE-----\n';

      var certStr = '-----BEGIN CERTIFICATE-----MIIDJjCCAg6gAwIBAgIIe8gkFPR+H/wwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UEAxMrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAeFw0xNzA3MjAxMTQzMzRaFw0xNzA3MjMxMjEzMzRaMDYxNDAyBgNVBAMTK2ZlZGVyYXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCpJedl82hPWQTTvgqwghN1VNMEe8LyyHFCaUfkSOPKzwfr27OSZP9peXv09Qk/BJExuJuuANENRPNlbQzRCwGVgJSGWoYldhr4kPNtbLQa/RtSxygwlx8Y++q7WFriDbDuNFwNWCYAhXf7FedrALSW7yaKwEAsYzvsxZdQZSvTQrMEwY8ReEFTB/FOzbVy1JRlaPbapkgUCSl/FUt22o/skaRRYyOqVderln1lnVbwafO1AvGtOxXS7jgTQOlTR7w4ndE6a6VVukI9UrO3g3r2z7tdUzVDGkp5/tkWa4MSDeWLz/9OuBX1lowrxks2R6FTc5UwgtRR9b5XmJOlj5ndAgMBAAGjODA2MAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQAtgCW2yYYY5HsbKZrUhJCGlcExVNJ5P108hfTptEEgzb5LAGeQphqq/17/1CEbGN3AEjAf6jQc1XH0W9C6OW3ZDXAG8U0jDpjfdKcLE50K7DdGmllJPHfVdQAr5l4bY8gpGClrj1m2GamPuAfub8cT/W3X5b6G6OCw9zPkwO9yL+9CiTmk27rqoGoo5+brj5eVdutjtrtjwmJG9AJ+sshovF8s2rBwqzl7j11tMNx7zGIV/Np4t9l67n9KQnHwjD4bJ5qmy2T3EzbkuTZk4DE7hRQb5rZdjiG0qED/kJjfz36x3IPE6s+YxHJOPtijUDtYTsK4HrtEkEJjDYk4E9XK-----END CERTIFICATE-----';

      var pubkey = KEYUTIL.getKey(certStr);

      var isValid = KJUR.jws.JWS.verifyJWT(token, pubkey, {alg: ['RS256']});

      $('#Tulemus').text(isValid.toString());

    }
  </script>

</head>

<body onload="alusta()">
  <div class='container-fluid'>
    <div class='row'>
      <div class='col-xs-12 col-sm-10 col-md-8 col-lg-8 col-xl-6'>

        <div id='Tulemus'></div>

      </div>
    </div>
</body>

</html>